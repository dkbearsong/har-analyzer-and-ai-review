<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAR Analysis Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <style>
        .flex-container {
            padding: 75px;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .tt {
            padding-left: 25px
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <span class="navbar-brand mb-0 h1 tt">Har Analyzer</span>
    </nav>
    <div class="flex-container">
        <h3>Response Code Details</h3>
        <div class="accordion" id="summaryaccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        1XX: Informational
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <strong>Total 1XX Responses:</strong> {{ summary.status_code_counts[1] }}
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                        2XX: Informational
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <strong>Total 2XX Responses:</strong> {{ summary.status_code_counts[2] }}
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                        3XX: Informational
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <strong>Total 3XX Responses:</strong> {{ summary.status_code_counts[3] }}
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
                        4XX: Informational
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <strong>Total 4XX Responses:</strong> {{ summary.status_code_counts[4] }}
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
                        5XX: Informational
                    </button>
                </h2>
                <div id="collapseFive" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <strong>Total 5XX Responses:</strong> {{ summary.status_code_counts[5] }}
                    </div>
                </div>
            </div>
        </div>
        <br>
        <br>
                
        <div class="summary">
            <h1>Summary</h1>
            <div>
                <p><strong>Total Requests:</strong> {{ summary.total_requests }}</p>
                <p><strong>Total Time:</strong> {{ summary.total_time }} ms</p>
                <p><strong>Average Time:</strong> {{ summary.average_time }} ms</p>
                <p><strong>Success Count:</strong> {{ summary.success_count }}</p>
                <p><strong>Failure Count:</strong> {{ summary.failure_count }}</p>
            </div>
        </div>
        

        <h2>Request Details</h2>
        <table class="table table-hover table-striped-columns">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>URL</th>
                    <th>Status</th>
                    <th>Content-Type</th>
                    <th>Time (ms)</th>
                    <th>Source IP</th>
                    <th>Response Size (KB)</th>
                    <th>Latency (ms)</th> <!-- New Field for Latency -->
                    <th>Time Breakdown</th>
                    <th>Error Message</th>
                    <th>Request Payload</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in entries_data %}
                <tr>
                    <td>{{ entry.method }}</td>
                    <td>
                        <span title="{{ entry.url }}">{{ entry.url[:60] }}{% if entry.url|length > 60 %}...{% endif
                            %}</span>
                    </td>
                    <td>{{ entry.status }}</td>
                    <td>{{ entry.content_type }}</td>
                    <td>{{ entry.time }}</td>
                    <td>{{ entry.source_ip }}</td>
                    <td>{{ (entry.response_size / 1024) | round(2) }} KB</td> <!-- Convert size to KB -->
                    <td>
                        {{ (entry.timings.dns + entry.timings.connect + entry.timings.send + entry.timings.wait +
                        entry.timings.receive) | round(2) }} ms
                    </td> <!-- Calculate and display total latency -->
                    <td>
                        DNS: {{ entry.timings.dns }} ms<br>
                        Connect: {{ entry.timings.connect }} ms<br>
                        Send: {{ entry.timings.send }} ms<br>
                        Wait: {{ entry.timings.wait }} ms<br>
                        Receive: {{ entry.timings.receive }} ms
                    </td>
                    <td>{{ entry.error_message if entry.error_message else 'N/A' }}</td>
                    <td>{{ entry.payload }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>


            <footer>
                <figure class="text-center">
                    <blockquote class="blockquote">
                        <p>Template Created By <a href="https://rahulranjan.org" style="color: rgb(30, 8, 8);">Rahul Ranjan</a>.</p>
                    </blockquote>
                    <figcaption class=""blockquote-footer">â€” AI integration and Bootstrap restyling by Dereck Bearsong</figcaption>
                </figure>
            </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    </div>
  </body>

</html>